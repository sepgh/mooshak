<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Mooshak Server # Setup # To setup a mooshak server you will need git, docker and docker compose (comes with docker itself in latest versions) installed.
Go to directory of your choice and clone the project.
git clone https://github.com/sepgh/mooshak Next, go to newly cloned mooshak directory and then navigate to server directory.
cd mooshak # cloned directory cd server # server scripts After that, create required docker volume and networks, then you can start mooshak by runing the docker compose:"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Server"><meta property="og:description" content="Mooshak Server # Setup # To setup a mooshak server you will need git, docker and docker compose (comes with docker itself in latest versions) installed.
Go to directory of your choice and clone the project.
git clone https://github.com/sepgh/mooshak Next, go to newly cloned mooshak directory and then navigate to server directory.
cd mooshak # cloned directory cd server # server scripts After that, create required docker volume and networks, then you can start mooshak by runing the docker compose:"><meta property="og:type" content="article"><meta property="og:url" content="https://sepgh.github.io/mooshak/docs/server/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-03-03T18:55:36+03:30"><title>Server | Mooshak</title><link rel=manifest href=../../manifest.json><link rel=icon href=../../favicon.png type=image/x-icon><link rel=stylesheet href=../../book.min.a82d7e77ceb134d151c4d7e381eeb30623fbd5a524d58c584d8716ecec0205bd.css integrity="sha256-qC1+d86xNNFRxNfjge6zBiP71aUk1YxYTYcW7OwCBb0=" crossorigin=anonymous><script defer src=../../flexsearch.min.js></script>
<script defer src=../../en.search.min.78166b9d46e23e0ea915cb6887a30b633e7bc4fad10c8b6b9f6fa532271c19ba.js integrity="sha256-eBZrnUbiPg6pFctoh6MLYz57xPrRDItrn2+lMiccGbo=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4QMM7C7BZL"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4QMM7C7BZL",{anonymize_ip:!1})}</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=../../><span>Mooshak</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=../../><strong>Home</strong></a></li><li><a href=../../docs/server/ class=active><strong>Server</strong></a></li><li><strong>Clients</strong><ul><li><a href=../../docs/clients/windows/>Windows</a></li><li><a href=../../docs/clients/linux/>Linux</a></li></ul></li></ul><hr><p>Feel free to contribute to the project and ask your questions on <a href=https://github.com/sepgh/mooshak><strong>Github</strong></a>.</p></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=../../svg/menu.svg class=book-icon alt=Menu></label>
<strong>Server</strong>
<label for=toc-control><img src=../../svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#setup>Setup</a></li><li><a href=#managing-users>Managing users</a></li><li><a href=#run-behind-nginx---websocket>Run behind Nginx - Websocket</a></li></ul></nav></aside></header><article class=markdown><h1 id=mooshak-server>Mooshak Server
<a class=anchor href=#mooshak-server>#</a></h1><h2 id=setup>Setup
<a class=anchor href=#setup>#</a></h2><p>To setup a mooshak server you will need <code>git</code>, <code>docker</code> and <code>docker compose</code> (comes with docker itself in latest versions) installed.</p><p>Go to directory of your choice and clone the project.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone https://github.com/sepgh/mooshak
</span></span></code></pre></div><p>Next, go to newly cloned <code>mooshak</code> directory and then navigate to <code>server</code> directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cd mooshak  <span style=color:#75715e># cloned directory</span>
</span></span><span style=display:flex><span>cd server  <span style=color:#75715e># server scripts</span>
</span></span></code></pre></div><p>After that, create required docker volume and networks, then you can start <code>mooshak</code> by runing the docker compose:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Network and volume:</span>
</span></span><span style=display:flex><span>docker volume create mooshak_sshd
</span></span><span style=display:flex><span>docker network create mooshak
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Running:</span>
</span></span><span style=display:flex><span>docker compose up -d  <span style=color:#75715e># or: docker-compose up -d</span>
</span></span></code></pre></div><p>Congradulations! You have mooshak ready to be used. The SSH server will be available on port <code>2255</code>, and websocket tunnel will be available on port <code>3344</code>.</p><p>To stop the mooshak server go to the same directory and then use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker compose down
</span></span></code></pre></div><h2 id=managing-users>Managing users
<a class=anchor href=#managing-users>#</a></h2><p>The <code>mooshak</code> container has scripts installed to help you add or remove users.</p><p>First you need to find the running container:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker ps
</span></span></code></pre></div><p>Example output:</p><pre tabindex=0><code>CONTAINER ID   IMAGE                COMMAND                  CREATED         STATUS         PORTS                                   NAMES
ac057f82ebd8   mooshak10-wstunnel   &#34;/bin/sh -c &#39;/wstunnâ€¦&#34;   3 seconds ago   Up 2 seconds   0.0.0.0:3344-&gt;80/tcp, :::3344-&gt;80/tcp   mooshak10-wstunnel-1
64f256e4f023   mooshak              &#34;/entrypoint.sh&#34;         3 seconds ago   Up 3 seconds   0.0.0.0:2255-&gt;22/tcp, :::2255-&gt;22/tcp   mooshak_sshd
</code></pre><p>The container ID we are looking for is <code>64f256e4f023</code> in this example, with image name <code>mooshak_sshd</code>.</p><p>To add a new user (or update their password) use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ docker exec &lt;COONTAINER ID HERE&gt; /adduser.sh &lt;username&gt; &lt;password&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Eaxmple valid output:  chpasswd: password for &#39;test&#39; changed</span>
</span></span></code></pre></div><p>To remove a user (and terminate their open session) use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ docker exec &lt;COONTAINER ID HERE&gt; /deleteuser.sh &lt;username&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Example valid output: deluser: can&#39;t find test in /etc/group</span>
</span></span></code></pre></div><h2 id=run-behind-nginx---websocket>Run behind Nginx - Websocket
<a class=anchor href=#run-behind-nginx---websocket>#</a></h2><p>You can configure your Nginx setup to forward websocket connections to websocket port listened by Mooshak WsTunnel (<code>3344</code>).</p><p>Here is a sample path configuration to add to your Nginx setup:</p><pre tabindex=0><code>location /mooshak {
        proxy_pass http://127.0.0.1:3344;
        proxy_http_version  1.1;
        proxy_set_header    Upgrade $http_upgrade;
        proxy_set_header    Connection &#34;upgrade&#34;;
        proxy_set_header    Host $http_host;
        proxy_set_header    X-Real-IP $remote_addr;

        proxy_connect_timeout       10m;
        proxy_send_timeout          10m;
        proxy_read_timeout          90m;
        send_timeout                10m;
}
</code></pre><p>Reload your Nginx service and you are good to go.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#setup>Setup</a></li><li><a href=#managing-users>Managing users</a></li><li><a href=#run-behind-nginx---websocket>Run behind Nginx - Websocket</a></li></ul></nav></div></aside></main></body></html>